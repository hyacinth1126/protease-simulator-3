# 초기 속도(v₀) 결정 요인

## 📊 현재 코드에서의 초기 속도 계산 방법

### 계산 방식
현재 코드는 **선형 구간 분석(Linear Phase Analysis)**을 사용하여 초기 속도를 계산합니다:

```python
F(t) = F0 + v0 * t
```

여기서:
- **v₀**: 초기 속도 (기울기) = dF/dt (형광 단위/시간 단위)
- **F₀**: 초기 형광값 (y절편)
- **t**: 시간

### 선형 구간 선택
- **linear_fraction = 0.2** (기본값: 처음 20% 데이터 사용)
- **min_points = 3** (최소 3개 데이터 포인트 필요)
- 초기 반응 구간에서 기질 농도가 거의 일정하고, 효소-기질 복합체 형성이 선형적으로 증가하는 구간을 선택

---

## 🔬 초기 속도를 결정하는 요인들

### 1️⃣ **실험적 요인 (Experimental Factors)**

#### A. 선형 구간 선택 (Linear Phase Selection)
- **선형 구간의 길이**: `linear_fraction` 파라미터로 조절 (기본값: 20%)
  - 너무 짧으면: 노이즈에 민감, 부정확
  - 너무 길면: 비선형 구간 포함, 과소평가
- **최소 데이터 포인트**: `min_points` (기본값: 3)
  - 최소한 3개 이상의 데이터 포인트 필요

#### B. 데이터 품질
- **측정 정확도**: RFU 값의 정밀도
- **시간 해상도**: 초기 구간의 데이터 포인트 밀도
- **노이즈 수준**: 측정 오차

#### C. 측정 조건
- **온도**: 반응 속도에 직접적 영향
- **pH**: 효소 활성에 영향
- **이온 강도**: 효소-기질 상호작용에 영향

---

### 2️⃣ **이론적 요인 (Theoretical Factors) - Michaelis-Menten Kinetics**

#### A. 기질 농도 [S] (Substrate Concentration)
**표준 MM 방정식:**
```
v₀ = (Vmax × [S]) / (Km + [S])
```

- **[S] << Km** (저농도): v₀ ≈ (Vmax/Km) × [S] → **선형 관계**
- **[S] = Km** (중간농도): v₀ = Vmax/2
- **[S] >> Km** (고농도): v₀ ≈ Vmax → **포화**

#### B. 효소 농도 [E] (Enzyme Concentration)
```
Vmax = kcat × [E]_T
v₀ = (kcat × [E]_T × [S]) / (Km + [S])
```

- **[E]가 증가** → Vmax 증가 → v₀ 증가 (선형 관계)
- **Substrate 고정 + Enzyme 변화** 실험에서는:
  - v₀ = (kcat × [S] / (Km + [S])) × [E]
  - v₀는 [E]에 대해 **선형**

#### C. Michaelis-Menten 파라미터
- **Km (Michaelis 상수)**: 기질에 대한 효소의 친화도
  - Km이 작을수록: 높은 친화도 → 높은 v₀
  - Km이 클수록: 낮은 친화도 → 낮은 v₀
  
- **kcat (turnover number)**: 효소 분자당 최대 반응 속도
  - kcat이 클수록: 빠른 반응 → 높은 v₀
  
- **kcat/Km (catalytic efficiency)**: 효소의 효율성
  - [S] << Km 조건에서: v₀ ≈ (kcat/Km) × [E] × [S]

---

### 3️⃣ **현재 코드에서의 계산 과정**

```python
# 1. 선형 구간 선택 (처음 20% 데이터)
n_linear = int(n_total * 0.2)  # linear_fraction = 0.2

# 2. 선형 피팅
coeffs = np.polyfit(linear_times, linear_values, 1)
v0 = coeffs[0]  # 기울기 = 초기 속도
F0 = coeffs[1]  # y절편 = 초기 형광값

# 3. R² 계산 (피팅 품질 평가)
r_squared = 1 - (ss_res / ss_tot)
```

---

## ⚠️ 주의사항

### 선형 구간 선택의 중요성
1. **너무 이른 구간**: 노이즈가 많을 수 있음
2. **너무 늦은 구간**: 기질 고갈, 비선형 구간 포함
3. **최적 구간**: 기질 농도가 거의 일정하고, 효소-기질 복합체 형성이 선형인 구간

### Substrate 고정 + Enzyme 변화 실험
- v₀는 [E]에 대해 **선형** 관계
- **Km을 구할 수 없음** (기질 농도 gradient 필요)
- 구할 수 있는 것: **slope = kcat × [S] / (Km + [S])**

---

## 📌 요약

**초기 속도(v₀)를 결정하는 주요 요인:**

1. ✅ **기질 농도 [S]** - MM 방정식의 핵심 변수
2. ✅ **효소 농도 [E]** - Vmax = kcat × [E]
3. ✅ **Km (Michaelis 상수)** - 기질 친화도
4. ✅ **kcat (turnover number)** - 효소 활성
5. ✅ **선형 구간 선택** - 실험적 측정 방법
6. ✅ **측정 조건** - 온도, pH, 이온 강도 등

**현재 코드의 계산 방식:**
- 선형 구간(처음 20%)의 기울기를 초기 속도로 사용
- F(t) = F0 + v0 × t (선형 피팅)


